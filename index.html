<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Hit⚡️Points — Mini App</title>
  <meta name="description" content="Минималистичный мобильный mini-app для кофе и доставки — Hit⚡️Points" />
  <style>
    /* === Reset & base === */
    :root{
      --bg: #f6f7f8;
      --card:#ffffff;
      --muted:#6b7280;
      --accent:#0ea5a4; /* teal-ish accent */
      --accent-dark:#088a86;
      --danger:#ef4444;
      --glass: rgba(255,255,255,0.6);
      --shadow: 0 6px 18px rgba(20,20,30,0.06), inset 0 1px 0 rgba(255,255,255,0.6);
      --radius: 14px;
      --btn-radius: 16px;
      --max-width: 480px; /* app max width */
    }
    *{box-sizing: border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,var(--bg), #fdfdfd 60%);
      color:#0f172a;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      -webkit-tap-highlight-color: transparent;
      padding: env(safe-area-inset-top) 12px env(safe-area-inset-bottom);
      display:flex;justify-content:center;
    }
    .app{
      width: 100%;
      max-width: var(--max-width);
      min-height:100vh;
      display:flex;flex-direction:column;
      gap:12px;
    }

    /* header */
    header{position:sticky;top:env(safe-area-inset-top);z-index:20;padding:14px 6px 0;}
    .topbar{
      display:flex;align-items:center;gap:12px;background:transparent;
    }
    .brand{
      display:flex;align-items:center;gap:10px;padding:8px 12px;border-radius:12px;backdrop-filter: blur(6px);-webkit-backdrop-filter: blur(6px);
      background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.55));box-shadow: var(--shadow);
    }
    .logo{display:flex;align-items:center;gap:8px}
    .logo .circle{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#fff,#f3f4f6);box-shadow:0 4px 10px rgba(10,10,20,0.06);}
    .logo svg{width:22px;height:22px}
    .brand h1{font-size:16px;margin:0;line-height:1;letter-spacing:-0.2px}
    .brand p{margin:0;font-size:12px;color:var(--muted)}

    /* content */
    main{flex:1;overflow:auto;padding-bottom:96px}
    .hero{padding:14px;border-radius:16px;background:linear-gradient(180deg,#fff,#fbfcfd);box-shadow:var(--shadow);}
    .hero h2{margin:0;font-size:18px}
    .hero p{margin:6px 0 0;color:var(--muted);font-size:13px}

    /* menu list */
    .menu{display:grid;gap:12px;margin-top:6px}
    .card{
      background:var(--card);border-radius:14px;padding:12px;box-shadow: 0 4px 14px rgba(20,20,30,0.04);border: 1px solid rgba(15,20,40,0.03);
      display:flex;align-items:flex-start;gap:12px;overflow:hidden
    }
    .item-media{width:72px;min-width:72px;height:72px;border-radius:12px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#fff,#f7fafb);box-shadow:0 6px 14px rgba(10,10,20,0.04)}
    .item-body{flex:1}
    .item-title{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .item-title h3{margin:0;font-size:15px}
    .price{font-weight:600}
    .desc{margin-top:6px;color:var(--muted);font-size:13px;line-height:1.35}

    /* controls */
    .controls{display:flex;gap:8px;align-items:center;margin-top:10px}
    .btn{
      appearance:none;border:0;padding:10px 14px;border-radius:var(--btn-radius);font-weight:600;display:inline-flex;align-items:center;gap:8px;justify-content:center;
      background:linear-gradient(180deg,var(--accent),var(--accent-dark));color:#fff;box-shadow: 0 8px 20px rgba(14,165,164,0.14);cursor:pointer;
      transition: transform .12s ease, box-shadow .12s ease;min-height:44px
    }
    .btn:active{transform:translateY(1px)}
    .btn.ghost{background:transparent;color:var(--accent);box-shadow:none;border:1px solid rgba(8,138,134,0.12)}

    .qty{display:inline-flex;align-items:center;border-radius:10px;overflow:hidden;border:1px solid rgba(15,20,40,0.05)}
    .qty button{background:transparent;border:0;padding:8px 10px;font-weight:700;cursor:pointer}
    .qty span{display:inline-block;padding:8px 12px;background:linear-gradient(180deg,#fff,#fafafa);min-width:34px;text-align:center}

    /* bottom cart bar */
    .cart-bar{
      position:fixed;left:50%;transform:translateX(-50%);bottom:env(safe-area-inset-bottom);width:100%;max-width:var(--max-width);padding:10px;pointer-events:none;
    }
    .cart-inner{pointer-events:auto;background:linear-gradient(180deg,#ffffff,#fbffff);border-radius:18px;padding:10px 12px;display:flex;align-items:center;justify-content:space-between;gap:12px;box-shadow:0 12px 30px rgba(10,10,20,0.08);border:1px solid rgba(15,20,40,0.04)}
    .cart-info{display:flex;align-items:center;gap:10px}
    .cart-info strong{font-size:15px}
    .small-muted{font-size:13px;color:var(--muted)}

    /* modal / sheet */
    .sheet{position:fixed;left:0;right:0;bottom:0;top:28%;border-top-left-radius:18px;border-top-right-radius:18px;background:linear-gradient(180deg,#fff,#fbfdff);box-shadow:0 -20px 40px rgba(10,10,20,0.06);padding:14px;display:none;flex-direction:column;gap:12px;z-index:40}
    .sheet.open{display:flex}
    .sheet .line{height:6px;width:56px;border-radius:999px;background:#e6e9ef;margin:0 auto}
    .sheet .list{overflow:auto;max-height:40vh}

    /* form */
    .field{display:flex;flex-direction:column;gap:6px}
    input[type=text]{padding:12px;border-radius:12px;border:1px solid rgba(15,20,40,0.06);background:linear-gradient(180deg,#fff,#fbfdff);outline:none}
    label{font-size:13px;color:var(--muted)}

    /* responsive safety */
    @media (max-width:420px){
      :root{--btn-radius:14px;--radius:12px}
      .item-media{width:62px;height:62px;min-width:62px}
    }

    /* tiny accessibility tweaks */
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;border:0;overflow:hidden;clip:rect(0 0 0 0)}
  </style>
</head>
<body>
  <div class="app" id="app">
    <header>
      <div class="topbar">
        <div class="brand">
          <div class="logo">
            <div class="circle" aria-hidden>
              <!-- coffee + lightning svg -->
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="3" width="20" height="14" rx="3" fill="#fff" stroke="#000" stroke-opacity="0.06"/><path d="M8 10h6" stroke="#0ea5a4" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><path d="M13 3l-3 5h3l-1 5 5-6h-3l1-4" fill="#fde68a" stroke="#f59e0b" stroke-width="0.6"/></svg>
            </div>
          </div>
          <div>
            <h1>Hit⚡️Points</h1>
            <p>Минимализм. Быстрая доставка.</p>
          </div>
        </div>
        <div style="margin-left:auto">
          <button class="btn ghost" id="openCartBtn" aria-label="Открыть корзину">Корзина</button>
        </div>
      </div>
    </header>

    <main>
      <section class="hero">
        <h2>Доставка кофе и еды — быстро и аккуратно</h2>
        <p>Акцент на качестве: удобный интерфейс, понятные кнопки и аккуратная типографика. Одна страница — всё, что нужно.</p>
      </section>

      <section class="menu" id="menu">
        <!-- menu items injected by JS for clarity -->
      </section>

      <section style="margin-top:6px">
        <div class="card">
          <div style="flex:1">
            <h3 style="margin:0">Опции доставки</h3>
            <p class="small-muted" style="margin:6px 0 0">Мы доставляем в радиусе 8 км. Время — ~30–45 минут.</p>
            <div style="margin-top:10px;display:flex;gap:8px;align-items:center">
              <label style="display:inline-flex;align-items:center;gap:8px">
                <input type="checkbox" id="deliveryToggle" checked />
                <span class="small-muted">Доставка</span>
              </label>
              <div style="flex:1"></div>
              <button class="btn ghost" id="contactBtn">Контакты</button>
            </div>
            <div id="addressWrap" style="margin-top:10px">
              <div class="field"><label for="address">Адрес для доставки</label><input id="address" type="text" placeholder="ул. Примерная, д. 1, кв. 12"/></div>
            </div>
          </div>
        </div>
      </section>

    </main>

    <!-- bottom cart bar -->
    <div class="cart-bar">
      <div class="cart-inner" role="region" aria-label="Корзина">
        <div class="cart-info">
          <div style="width:48px;height:48px;border-radius:12px;background:linear-gradient(180deg,#fff,#f3f4f6);display:flex;align-items:center;justify-content:center">☕️</div>
          <div>
            <div style="display:flex;gap:8px;align-items:center"><strong id="cartCount">0 товаров</strong><span class="small-muted" id="cartSum">—</span></div>
            <div class="small-muted" id="eta">Самовывоз • 0–0 мин</div>
          </div>
        </div>
        <div style="display:flex;gap:8px;align-items:center">
          <button class="btn ghost" id="viewBtn">Просмотр</button>
          <button class="btn" id="orderBtn" disabled>Оформить</button>
        </div>
      </div>
    </div>

    <!-- sheet / cart modal -->
    <div class="sheet" id="sheet" aria-hidden="true">
      <div class="line" aria-hidden></div>
      <h3 style="margin:6px 0 0">Ваша корзина</h3>
      <div class="list" id="cartList" style="margin-top:8px"></div>
      <div style="display:flex;gap:8px;align-items:center;justify-content:space-between;margin-top:8px">
        <div>
          <div class="small-muted">Итого</div>
          <strong id="totalPrice">0 ₽</strong>
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn ghost" id="clearBtn">Очистить</button>
          <button class="btn" id="checkoutBtn" disabled>Оформить заказ</button>
        </div>
      </div>
    </div>

  </div>

  <script>
    // ===== Data =====
    const MENU = [
      { id: 'shawarma', title: 'Сочная шаурма', price: 300, desc: 'Нежное мясо, свежие овощи, соус, который взорвёт ваши вкусовые рецепторы!' },
      { id: 'burger', title: 'Эпические бургеры', price: 300, desc: 'Сочные котлеты, хрустящий салат, всё в идеальной булочке!' },
      { id: 'fries', title: 'Хрустящая картошка фри', price: 150, desc: 'Золотистая, идеально прожаренная, с хрустом на каждом кусочке!' },
      { id: 'hotdog', title: 'Классические хот-доги', price: 150, desc: 'Пикантные, сытные, для быстрого заряда!' },
      { id: 'drinks', title: 'Освежающие напитки', price: 20, desc: 'От газировки до лимонадов, чтобы запить этот фестиваль вкусов!' }
    ];

    // ===== state =====
    const state = { cart: {}, delivery: true };

    // ===== ui helpers =====
    const $ = sel => document.querySelector(sel);
    const $$ = sel => document.querySelectorAll(sel);

    function formatRub(n){ return n.toLocaleString('ru-RU') + ' ₽' }

    // ===== render menu =====
    const menuRoot = $('#menu');
    function renderMenu(){
      menuRoot.innerHTML = '';
      MENU.forEach(item=>{
        const el = document.createElement('div'); el.className='card';
        el.innerHTML = `
          <div class="item-media" aria-hidden>
            <svg width="44" height="44" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="3" width="20" height="14" rx="3" fill="#fff" stroke="#000" stroke-opacity="0.04"/><path d="M7 9h10" stroke="#94a3b8" stroke-width="1.4" stroke-linecap="round"/><path d="M9 14c1.2-1.5 4-2 6-1" stroke="#eab308" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
          </div>
          <div class="item-body">
            <div class="item-title">
              <h3>${item.title} <span style="font-size:12px;color:var(--muted);font-weight:500">от ${item.price} р</span></h3>
              <div class="price">${formatRub(item.price)}</div>
            </div>
            <div class="desc">${item.desc}</div>
            <div class="controls">
              <div class="qty" data-id="${item.id}">
                <button data-action="minus" aria-label="Уменьшить">−</button>
                <span data-count>0</span>
                <button data-action="plus" aria-label="Добавить">+</button>
              </div>
              <button class="btn" data-add="${item.id}">Добавить</button>
            </div>
          </div>
        `;
        menuRoot.appendChild(el);
      });
      attachMenuHandlers();
    }

    function attachMenuHandlers(){
      $$('#menu .qty').forEach(q => {
        const id = q.getAttribute('data-id');
        q.querySelector('[data-action="plus"]').addEventListener('click', ()=>{
          changeQty(id, 1);
        });
        q.querySelector('[data-action="minus"]').addEventListener('click', ()=>{
          changeQty(id, -1);
        });
      });
      $$('#menu [data-add]').forEach(b=>{
        b.addEventListener('click', e=>{
          const id = e.currentTarget.getAttribute('data-add');
          addToCart(id, 1);
        })
      });
    }

    // ===== cart logic =====
    function changeQty(id, delta){
      const el = document.querySelector(`.qty[data-id="${id}"] span`);
      let cur = parseInt(el.textContent,10) || 0;
      cur = Math.max(0, cur + delta);
      el.textContent = cur;
      // not added to cart until "Добавить" pressed — this prevents accidental cart pollution
    }

    function addToCart(id, qty=1){
      const item = MENU.find(m=>m.id===id);
      if(!item) return;
      state.cart[id] = (state.cart[id] || 0) + qty;
      // reset visible quick qty
      const quick = document.querySelector(`.qty[data-id="${id}"] span`);
      if(quick) quick.textContent = 0;
      refreshCartUI();
      flashButton(`#menu [data-add="${id}"]`);
    }

    function flashButton(selector){
      const b = document.querySelector(selector);
      if(!b) return;
      b.animate([{transform:'scale(1)'},{transform:'scale(.98)'},{transform:'scale(1)'}],{duration:220})
    }

    function refreshCartUI(){
      const count = Object.values(state.cart).reduce((s,n)=>s+n,0);
      const sum = Object.entries(state.cart).reduce((s,[id,q])=>{
        const it = MENU.find(m=>m.id===id); return s + (it.price * q);
      },0);
      $('#cartCount').textContent = `${count} ${count===1? 'товар' : 'товаров'}`;
      $('#cartSum').textContent = count>0 ? formatRub(sum) : '—';
      $('#totalPrice').textContent = formatRub(sum);
      $('#orderBtn').disabled = count===0;
      $('#checkoutBtn').disabled = count===0;
      // ETA simple
      $('#eta').textContent = state.delivery ? 'Доставка • 30–45 мин' : 'Самовывоз • 10–20 мин';

      // render list
      const list = $('#cartList'); list.innerHTML = '';
      Object.entries(state.cart).forEach(([id,q])=>{
        const it = MENU.find(m=>m.id===id);
        const row = document.createElement('div'); row.style.display='flex';row.style.justifyContent='space-between';row.style.alignItems='center';row.style.padding='8px 0';
        row.innerHTML = `<div style="flex:1"><div style="display:flex;gap:10px;align-items:center"><div style="width:44px;height:44px;border-radius:10px;background:#fbfbfb;display:flex;align-items:center;justify-content:center">${it.title.split(' ')[0]}</div><div><div style="font-weight:600">${it.title}</div><div class="small-muted" style="font-size:13px">${formatRub(it.price)}</div></div></div></div><div style="display:flex;align-items:center;gap:8px"><button class="btn ghost" data-act="dec" data-id="${id}">−</button><div style="min-width:30px;text-align:center">${q}</div><button class="btn ghost" data-act="inc" data-id="${id}">+</button></div>`;
        list.appendChild(row);
      });

      // attach inc/dec in sheet
      $$('#cartList [data-act]').forEach(b=>{
        b.addEventListener('click', e=>{
          const id = e.currentTarget.getAttribute('data-id');
          if(e.currentTarget.getAttribute('data-act')==='inc'){
            addToCart(id,1);
          }else{
            decFromCart(id,1);
          }
        })
      });
    }

    function decFromCart(id, qty=1){
      if(!state.cart[id]) return;
      state.cart[id] = Math.max(0, state.cart[id]-qty);
      if(state.cart[id]===0) delete state.cart[id];
      refreshCartUI();
    }

    // ===== sheet controls =====
    const sheet = $('#sheet');
    $('#openCartBtn').addEventListener('click', ()=> toggleSheet(true));
    $('#viewBtn').addEventListener('click', ()=> toggleSheet(true));
    $('#checkoutBtn').addEventListener('click', ()=> doCheckout());
    $('#orderBtn').addEventListener('click', ()=> doCheckout());
    $('#clearBtn').addEventListener('click', ()=>{ state.cart={}; refreshCartUI(); toggleSheet(false); });
    $('#contactBtn').addEventListener('click', ()=>{ alert('Телефон: +7 900 000-00-00\nВремя работы: 09:00–22:00'); });

    function toggleSheet(open){
      sheet.classList.toggle('open', !!open);
      sheet.setAttribute('aria-hidden', !open);
    }

    function doCheckout(){
      const count = Object.values(state.cart).reduce((s,n)=>s+n,0);
      if(count===0) return alert('Ваша корзина пуста.');
      const sum = Object.entries(state.cart).reduce((s,[id,q])=>{
        const it = MENU.find(m=>m.id===id); return s + (it.price * q);
      },0);
      const address = document.getElementById('address').value.trim();
      const method = state.delivery ? 'Доставка' : 'Самовывоз';
      let summary = `Заказ — ${formatRub(sum)}\n${method}\nТоваров: ${count}`;
      if(state.delivery) summary += `\nАдрес: ${address || '[не указан]'}`;
      // For demo we just show alert — in real app here you'd call API
      alert(summary + '\n\n(Это демо — интегрируйте вызов на сервер в doCheckout)');
      // reset after order for demo
      state.cart = {};
      refreshCartUI();
      toggleSheet(false);
    }

    // delivery toggle
    $('#deliveryToggle').addEventListener('change', e=>{
      state.delivery = !!e.target.checked;
      document.getElementById('addressWrap').style.display = state.delivery ? 'block' : 'none';
      refreshCartUI();
    });

    // open sheet by dragging from top? small UX: close on outside click
    document.addEventListener('click', e=>{
      if(!sheet.classList.contains('open')) return;
      const inside = e.target.closest('.sheet');
      const openBtn = e.target.closest('#openCartBtn') || e.target.closest('#viewBtn');
      if(!inside && !openBtn){ toggleSheet(false); }
    });

    // init
    renderMenu(); refreshCartUI();

    // accessibility: keyboard
    document.addEventListener('keydown', e=>{ if(e.key==='Escape') toggleSheet(false); });

    // avoid content overflow: ensure body fits
    window.addEventListener('resize', ()=>{ document.body.style.minHeight = window.innerHeight + 'px'; });

  </script>
</body>
</html>
